<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>TurboRun ‚Äî Car Game</title>
  <style>
:root{
  --bg:#0b1020;
  --card:#0f1724;
  --accent:#ff6b00;
  --muted:#9aa4b2;
  --glass: rgba(255,255,255,0.03);
  --radius:12px;
  --font-sans: system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
}
*{box-sizing:border-box}
html,body{height:100%}
body{
  margin:0;
  font-family:var(--font-sans);
  background:linear-gradient(180deg,#071028 0%, #071423 60%);
  color:#e6eef6;
  line-height:1.35;
  padding-bottom:48px;
}
.site-header{
  display:flex;justify-content:space-between;align-items:center;
  padding:14px 20px;gap:12px;
  position:sticky;top:0;z-index:20;
  backdrop-filter: blur(6px);
  background: linear-gradient(180deg, rgba(11,16,32,0.6), rgba(11,16,32,0.35));
}
.brand{display:flex;align-items:center;gap:12px}
.brand h1{margin:0;font-size:18px}
.brand .tag{margin:0;font-size:12px;color:var(--muted)}
.nav{display:flex;gap:8px}
.nav-btn{
  background:transparent;border:0;padding:8px 12px;color:var(--muted);
  cursor:pointer;border-radius:8px;font-weight:600;
}
.nav-btn.active{color:#fff;background:linear-gradient(90deg, rgba(255,107,0,0.12), rgba(255,107,0,0.06))}
main{max-width:1100px;margin:20px auto;padding:12px}
.page{display:none}
.page.active{display:block}
.hero{
  display:flex;gap:18px;align-items:center;
  background:var(--card);padding:18px;border-radius:16px;
}
.hero-text h2{margin:0 0 8px;font-size:28px}
.hero-text p{margin:0 0 12px;color:var(--muted)}
.cta-row{display:flex;gap:10px}
.btn{
  background:var(--accent);color:#071422;padding:10px 14px;border-radius:10px;border:0;
  font-weight:700;cursor:pointer;
}
.btn.outline{background:transparent;color:var(--accent);border:1px solid rgba(255,107,0,0.12)}
.btn.small{padding:6px 8px;font-size:13px}
.btn.large{font-size:16px;padding:12px 18px}
.hero-art{flex:1;display:flex;justify-content:center;align-items:center}
.features{display:grid;grid-template-columns:repeat(auto-fit,minmax(160px,1fr));gap:12px;margin-top:14px}
.features article{background:var(--glass);padding:12px;border-radius:12px}
.play-header{display:flex;justify-content:space-between;align-items:center;margin-bottom:12px}
.game-area{display:flex;gap:12px;align-items:flex-start}
#game{background:linear-gradient(180deg,#2b2b2b,#141414);border-radius:10px;box-shadow:0 6px 20px rgba(0,0,0,0.6)}
.hud{min-width:160px;background:var(--card);padding:12px;border-radius:10px;display:flex;flex-direction:column;gap:8px}
.hud div{font-weight:600;color:var(--muted)}
.site-footer{
  position:fixed;left:0;right:0;bottom:0;padding:12px 20px;
  background:linear-gradient(180deg, rgba(7,10,28,0.9), rgba(7,10,28,0.95));
  display:flex;justify-content:space-between;color:var(--muted)
}
@media (max-width:900px){
  .hero{flex-direction:column}
  .game-area{flex-direction:column}
  .hud{min-width:auto;width:100%}
}
  </style>
</head>
<body>
  <header class="site-header">
    <div class="brand">
      <div class="logo">üèÅ</div>
      <div>
        <h1>TurboRun</h1>
        <p class="tag">Fast arcade racing in your browser</p>
      </div>
    </div>
    <nav class="nav">
      <button data-route="home" class="nav-btn active">Home</button>
      <button data-route="play" class="nav-btn">Play</button>
      <button data-route="leaderboard" class="nav-btn">Leaderboards</button>
      <button data-route="settings" class="nav-btn">Settings</button>
      <button data-route="about" class="nav-btn">About</button>
    </nav>
  </header>

  <main id="app">
    <section id="home" class="page active">
      <div class="hero">
        <div class="hero-text">
          <h2>Start your engines</h2>
          <p>Arcade-style top-down racing. Drift, dodge, and set records!</p>
          <div class="cta-row">
            <button id="start-play" class="btn large">Play Now</button>
            <button id="watch-demo" class="btn outline">How to Play</button>
          </div>
        </div>
        <div class="hero-art">
          <canvas id="hero-canvas" width="480" height="270"></canvas>
        </div>
      </div>
      <section class="features">
        <article><h3>Quick Races</h3><p>Jump into short tracks for instant fun.</p></article>
        <article><h3>Time Trials</h3><p>Beat your best time and climb leaderboards.</p></article>
        <article><h3>Upgrade Shop</h3><p>Earn coins and improve performance.</p></article>
      </section>
    </section>

    <section id="play" class="page">
      <div class="play-header">
        <div>
          <h2>Play ‚Äî Quick Race</h2>
          <p>Use ‚Üê ‚Üí to steer, ‚Üë accelerate, ‚Üì brake. Press P to pause.</p>
        </div>
        <div class="play-controls">
          <label>Difficulty
            <select id="difficulty">
              <option value="easy">Easy</option>
              <option value="normal" selected>Normal</option>
              <option value="hard">Hard</option>
            </select>
          </label>
          <button id="reset-score" class="btn small">Reset Best</button>
        </div>
      </div>
      <div class="game-area">
        <canvas id="game" width="900" height="540"></canvas>
        <aside class="hud">
          <div>Speed: <span id="speed">0</span></div>
          <div>Lap: <span id="lap">1</span></div>
          <div>Best: <span id="best">‚Äî</span></div>
          <div><button id="restart" class="btn small">Restart</button></div>
        </aside>
      </div>
    </section>

    <section id="leaderboard" class="page">
      <h2>Leaderboards</h2>
      <p>Top times (saved locally)</p>
      <ol id="leaders"></ol>
    </section>

    <section id="settings" class="page">
      <h2>Settings</h2>
      <label>Sound <input id="sound-toggle" type="checkbox" checked /></label>
      <label>Controls
        <select id="control-scheme">
          <option value="arrows">Arrow Keys</option>
          <option value="wasd">WASD</option>
        </select>
      </label>
      <p class="note">Settings are stored locally.</p>
    </section>

    <section id="about" class="page">
      <h2>About TurboRun</h2>
      <p>A browser-based car racing game built with HTML5 Canvas. Drift, dodge, and compete with your own records.</p>
      <p>Made for fun ‚Äî open-source and easy to extend.</p>
    </section>
  </main>

  <footer class="site-footer">
    <div>¬© TurboRun ‚Äî Demo</div>
    <div class="footer-links"><a id="github-link" href="#" target="_blank" rel="noopener">Source</a></div>
  </footer>

  <script>
  // ======= app.js =======
  (function(){
    const pages = document.querySelectorAll('.page');
    const navBtns = document.querySelectorAll('.nav-btn');
    function showPage(id){
      pages.forEach(p => p.id === id ? p.classList.add('active') : p.classList.remove('active'));
      navBtns.forEach(b => b.dataset.route === id ? b.classList.add('active') : b.classList.remove('active'));
    }
    function routeTo(route){ showPage(route); history.replaceState({}, '', '#'+route); }
    navBtns.forEach(b => b.addEventListener('click', ()=> routeTo(b.dataset.route)));
    const start = location.hash ? location.hash.replace('#','') : 'home';
    routeTo(start);
    const soundToggle = document.getElementById('sound-toggle');
    const controlScheme = document.getElementById('control-scheme');
    soundToggle.checked = JSON.parse(localStorage.getItem('turborun_sound') || 'true');
    controlScheme.value = localStorage.getItem('turborun_controls') || 'arrows';
    soundToggle.addEventListener('change', ()=> localStorage.setItem('turborun_sound', JSON.stringify(soundToggle.checked)));
    controlScheme.addEventListener('change', ()=> localStorage.setItem('turborun_controls', controlScheme.value));
    document.getElementById('watch-demo').addEventListener('click', ()=> alert('Drive with Arrow Keys. Cross the white line to finish a lap.'));
    document.getElementById('github-link').href = 'https://example.com/turborun';
    window.routeTo = routeTo;
  })();

  // ======= game.js =======
  (() => {
    const canvas = document.getElementById('game');
    const ctx = canvas.getContext('2d');
    const W = canvas.width, H = canvas.height;
    let running = false, lastTime=0, elapsed=0, lap=1;
    let best = parseFloat(localStorage.getItem('turborun_best')) || null;
    const hud = {speedEl:document.getElementById('speed'),lapEl:document.getElementById('lap'),bestEl:document.getElementById('best')};
    hud.bestEl.textContent = best ? best.toFixed(2)+'s' : '‚Äî';
    const settings={accel:0.18,maxSpeed:6,friction:0.985,turnSpeed:0.05};
    const car={x:140,y:H-120,angle:-Math.PI/2,speed:0,width:28,height:48,color:'#ffcc00'};
    const keys={left:0,right:0,up:0,down:0};
    window.addEventListener('keydown',e=>{
      if(e.key==='ArrowLeft'||e.key==='a')keys.left=1;
      if(e.key==='ArrowRight'||e.key==='d')keys.right=1;
      if(e.key==='ArrowUp'||e.key==='w')keys.up=1;
      if(e.key==='ArrowDown'||e.key==='s')keys.down=1;
      if(e.key==='p')togglePause();
    });
    window.addEventListener('keyup',e=>{
      if(e.key==='ArrowLeft'||e.key==='a')keys.left=0;
      if(e.key==='ArrowRight'||e.key==='d')keys.right=0;
      if(e.key==='ArrowUp'||e.key==='w')keys.up=0;
      if(e.key==='ArrowDown'||e.key==='s')keys.down=0;
    });
    const walls=[
      {x:0,y:0,w:W,h:12},{x:0,y:H-12,w:W,h:12},{x:0,y:0,w:12,h:H},{x:W-12,y:0,w:12,h:H},
      {x:200,y:80,w:480,h:18},{x:200,y:80,w:18,h:300},{x:660,y:80,w:18,h:300},{x:200,y:380,w:480,h:18}
    ];
    const startLine={x:120,y:H-160,w:60,h:6};
    function resetCar(){car.x=140;car.y=H-120;car.angle=-Math.PI/2;car.speed=0;elapsed=0;lap=1;hud.lapEl.textContent=lap;}
    function togglePause(){running=!running;if(running){lastTime=performance.now();requestAnimationFrame(loop);}}
    function rectsOverlap(a,b){return !(a.x+a.w<b.x||a.x>b.x+b.w||a.y+a.h<b.y||a.y>b.y+b.h);}
    function update(dt){
      const diff=document.getElementById('difficulty').value;
      if(diff==='easy'){settings.maxSpeed=5.2;settings.turnSpeed=0.06}
      else if(diff==='normal'){settings.maxSpeed=6;settings.turnSpeed=0.05}
      else{settings.maxSpeed=7.2;settings.turnSpeed=0.045}
      if(keys.up)car.speed+=settings.accel;
      if(keys.down)car.speed-=settings.accel*0.9;
      car.speed*=settings.friction;
      if(car.speed>settings.maxSpeed)car.speed=settings.maxSpeed;
      if(car.speed<-settings.maxSpeed*0.6)car.speed=-settings.maxSpeed*0.6;
      if(keys.left)car.angle-=settings.turnSpeed*(car.speed/settings.maxSpeed+0.25);
      if(keys.right)car.angle+=settings.turnSpeed*(car.speed/settings.maxSpeed+0.25);
      car.x+=Math.cos(car.angle)*car.speed;
      car.y+=Math.sin(car.angle)*car.speed;
      const carBox={x:car.x-car.width/2,y:car.y-car.height/2,w:car.width,h:car.height};
      for(const w of walls){if(rectsOverlap(carBox,w)){car.x-=Math.cos(car.angle)*car.speed*2;car.y-=Math.sin(car.angle)*car.speed*2;car.speed*=-0.25;}}
      const lineBox={x:startLine.x,y:startLine.y,w:startLine.w,h:startLine.h};
      if(rectsOverlap(carBox,lineBox)&&car.y<startLine.y+startLine.h&&car.speed>0.3){
        lap++;
        if(lap===2){
          const time=elapsed/1000;
          if(!best||time<best){best=time;localStorage.setItem('turborun_best',best);hud.bestEl.textContent=best.toFixed(2)+'s';}
          addLeader(time.toFixed(2));
          running=false;
          alert('Lap complete ‚Äî time: '+time.toFixed(2)+'s');
        }
        hud.lapEl.textContent=lap;
      }
      elapsed+=dt;
      hud.speedEl.textContent=Math.abs(car.speed).toFixed(2);
    }
    function roundRect(ctx,x,y,w,h,r){ctx.beginPath();ctx.moveTo(x+r,y);ctx.arcTo(x+w,y,x+w,y+h,r);ctx.arcTo(x+w,y+h,x,y+h,r);ctx.arcTo(x,y+h,x,y,r);ctx.arcTo(x,y,x+w,y,r);ctx.closePath();}
    function drawCar(c){ctx.save();ctx.translate(c.x,c.y);ctx.rotate(c.angle);ctx.fillStyle=c.color;roundRect(ctx,-c.width/2,-c.height/2,c.width,c.height,6);ctx.fill();ctx.fillStyle='rgba(10,10,20,0.6)';ctx.fillRect(-10,-c.height/2+6,20,10);ctx.restore();}
    function draw(){
      ctx.clearRect(0,0,W,H);
      ctx.fillStyle='#1b1b1b';ctx.fillRect(12,12,W-24,H-24);
      ctx.fillStyle='#0e1622';for(const w of walls){ctx.fillRect(w.x,w.y,w.w,w.h);}
      ctx.fillStyle='#fff';ctx.fillRect(startLine.x,startLine.y,startLine.w,startLine.h);
      drawCar(car);
    }
    function loop(now){if(!running)return;const dt=now-lastTime;lastTime=now;update(dt);draw();requestAnimationFrame(loop);}
    function addLeader(time){
      const list=JSON.parse(localStorage.getItem('turborun_leaders')||'[]');
      list.push({time:parseFloat(time),date:new Date().toISOString()});
      list.sort((a,b)=>a.time-b.time);
      localStorage.setItem('turborun_leaders',JSON.stringify(list.slice(0,10)));
      renderLeaders();
    }
    function renderLeaders(){
      const list=JSON.parse(localStorage.getItem('turborun_leaders')||'[]');
      const el=document.getElementById('leaders');if(!el)return;
      el.innerHTML=list.map(l=>`<li>${l.time.toFixed(2)}s ‚Äî ${new Date(l.date).toLocaleString()}</li>`).join('');
      hud.bestEl.textContent=best?best.toFixed(2)+'s':'‚Äî';
    }
    document.getElementById('restart').addEventListener('click',()=>{resetCar();running=true;lastTime=performance.now();requestAnimationFrame(loop);});
    document.getElementById('start-play').addEventListener('click',()=>{document.querySelectorAll('.nav-btn').forEach(b=>b.classList.remove('active'));document.querySelector('[data-route=\"play\"]').classList.add('active');window.routeTo('play');running=true;lastTime=performance.now();requestAnimationFrame(loop);});
    document.getElementById('reset-score').
